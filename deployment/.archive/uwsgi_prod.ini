[uwsgi]
# SciTeX Cloud uWSGI Production Configuration
# Based on AIRight's best practices

# Django-related settings
chdir = /home/ywatanabe/proj/SciTeX-Cloud
module = config.wsgi:application
home = /home/ywatanabe/proj/SciTeX-Cloud/.env

# Process-related settings
master = true
processes = 6
threads = 2
enable-threads = true

# Socket configuration (for nginx)
socket = /home/ywatanabe/proj/SciTeX-Cloud/uwsgi.sock
chmod-socket = 666
vacuum = true

# HTTP socket (for standalone testing)
# http-socket = :8000

# Logging
logto = /home/ywatanabe/proj/SciTeX-Cloud/logs/uwsgi.log
log-maxsize = 10485760  # 10MB
log-backupname = /home/ywatanabe/proj/SciTeX-Cloud/logs/uwsgi.log.old

# Performance tuning
max-requests = 5000
harakiri = 60
reload-mercy = 10
thunder-lock = true

# Static files handling (let nginx handle in production)
static-map = /static=/home/ywatanabe/proj/SciTeX-Cloud/staticfiles
static-map = /media=/home/ywatanabe/proj/SciTeX-Cloud/media

# Security
uid = ywatanabe
gid = ywatanabe

# Auto-reload on file changes (disable in production)
# py-autoreload = 1

# Buffer size
buffer-size = 32768

# Process naming
procname-prefix = scitex-cloud-

# PID file
pidfile = /home/ywatanabe/proj/SciTeX-Cloud/run/uwsgi.pid

# Stats server (for monitoring)
stats = 127.0.0.1:9192
stats-http = true

# Environment variables
env = DJANGO_SETTINGS_MODULE=config.settings.production
env = PYTHONPATH=/home/ywatanabe/proj/SciTeX-Cloud

# Graceful reload
reload-on-rss = 512

# Enable cheaper mode (spawn workers only when needed)
cheaper = 2
cheaper-initial = 2
cheaper-step = 1
cheaper-overload = 30

# Touch reload (useful for deployment)
touch-reload = /home/ywatanabe/proj/SciTeX-Cloud/config/wsgi.py

# EOF