{% load static %}
<!-- Bootstrap 5 JavaScript Bundle (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

<!-- Global Autocomplete Disabler -->
<script>
/**
 * GLOBAL POLICY: Disable autocomplete by default
 *
 * Prevents inappropriate autofill (e.g., username in repository name field).
 * To enable autocomplete on specific fields, add autocomplete="on", "email", etc.
 */
(function() {
  'use strict';

  function disableAutocompleteGlobally() {
    // Get all forms
    const forms = document.querySelectorAll('form');

    forms.forEach(function(form) {
      // Check if form explicitly has autocomplete="on" or specific value
      const formAutocomplete = form.getAttribute('autocomplete');
      const formWantsAutocomplete = formAutocomplete && formAutocomplete !== 'off';

      // Set form-level autocomplete
      if (!formWantsAutocomplete) {
        form.setAttribute('autocomplete', 'off');
      }

      // Process all inputs
      const inputs = form.querySelectorAll('input, textarea, select');
      inputs.forEach(function(input) {
        const inputAutocomplete = input.getAttribute('autocomplete');

        // List of valid autocomplete values that should be preserved
        const validAutocompleteValues = [
          'on', 'email', 'username', 'current-password', 'new-password',
          'name', 'given-name', 'family-name', 'tel', 'url', 'street-address',
          'postal-code', 'country', 'cc-number', 'cc-exp', 'cc-csc'
        ];

        // Only preserve autocomplete if it's explicitly set to a valid value
        const shouldPreserveAutocomplete = inputAutocomplete &&
          validAutocompleteValues.includes(inputAutocomplete);

        if (!shouldPreserveAutocomplete) {
          input.setAttribute('autocomplete', 'off');
          // Also add autocomplete="off" as property to override browser behavior
          input.autocomplete = 'off';
        }
      });
    });
  }

  // Run on page load
  document.addEventListener('DOMContentLoaded', disableAutocompleteGlobally);

  // Also run when content is dynamically added
  if (window.MutationObserver) {
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.addedNodes.length) {
          disableAutocompleteGlobally();
        }
      });
    });

    document.addEventListener('DOMContentLoaded', function() {
      observer.observe(document.body, {
        childList: true,
        subtree: true
      });
    });
  }
})();
</script>

<!-- Theme Switcher - Centralized script loading -->
<script src="{% static 'js/theme-switcher.js' %}?v=3"></script>

<!-- Highlight.js for syntax highlighting and line numbers -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>

<!-- Tooltip Auto-Positioning System -->
<script src="{% static 'js/tooltip-auto-position.js' %}"></script>

<!-- Other global scripts -->
<script src="{% static 'js/main.js' %}"></script>
<script src="{% static 'js/dropdown.js' %}"></script>
<script src="{% static 'js/code-blocks.js' %}"></script>
