{% load static %}

<!-- Syntax Highlighting Gallery -->
<div class="syntax-highlighting-gallery">
    <div class="intro-section">
        <p>This gallery showcases syntax highlighting for various file types supported in the file viewer. Uses <strong>highlight.js</strong> v11.9.0 with custom language definitions for specialized formats.</p>
        <p><strong>Custom Languages:</strong> BibTeX, LaTeX, and other markup formats are supported via custom language definitions.</p>
    </div>

    <!-- BibTeX Example -->
    <div class="language-example">
        <div class="example-header">
            <h3>BibTeX (.bib)</h3>
            <span class="file-extension">.bib</span>
        </div>
        <div class="example-description">
            Bibliography file format for LaTeX documents. Used for managing citations and references.
        </div>
        <pre><code class="language-bibtex">@article{einstein1905,
  author    = {Albert Einstein},
  title     = {On the Electrodynamics of Moving Bodies},
  journal   = {Annalen der Physik},
  volume    = {17},
  number    = {10},
  pages     = {891--921},
  year      = {1905},
  doi       = {10.1002/andp.19053221004}
}

@book{knuth1984,
  author    = {Donald E. Knuth},
  title     = {The {TeXbook}},
  publisher = {Addison-Wesley},
  year      = {1984},
  edition   = {1st}
}

% This is a comment
@inproceedings{smith2020,
  author    = {John Smith and Jane Doe},
  title     = {Advanced Techniques in Machine Learning},
  booktitle = {Proceedings of ICML},
  year      = {2020},
  pages     = {123--135}
}</code></pre>
    </div>

    <!-- Python Example -->
    <div class="language-example">
        <div class="example-header">
            <h3>Python</h3>
            <span class="file-extension">.py</span>
        </div>
        <div class="example-description">
            General-purpose programming language. Widely used for data science, web development, and automation.
        </div>
        <pre><code class="language-python">#!/usr/bin/env python3
"""Module docstring explaining the purpose."""

def fibonacci(n: int) -> list[int]:
    """Calculate fibonacci sequence up to n."""
    if n <= 0:
        return []
    elif n == 1:
        return [1]
    
    sequence = [1, 1]
    for i in range(2, n):
        sequence.append(sequence[-1] + sequence[-2])
    return sequence

class DataProcessor:
    """Process and transform data efficiently."""
    
    def __init__(self, data: dict):
        self.data = data
        self.processed = False
    
    def process(self) -> dict:
        """Transform the input data."""
        result = {k: v * 2 for k, v in self.data.items()}
        self.processed = True
        return result

if __name__ == "__main__":
    print(fibonacci(10))  # Output: [1, 1, 2, 3, 5, 8, 13, 21, 34]</code></pre>
    </div>

    <!-- JavaScript/TypeScript Example -->
    <div class="language-example">
        <div class="example-header">
            <h3>TypeScript</h3>
            <span class="file-extension">.ts</span>
        </div>
        <div class="example-description">
            JavaScript with static typing. Used for building type-safe frontend applications.
        </div>
        <pre><code class="language-typescript">interface User {
  id: number;
  name: string;
  email: string;
  roles: string[];
}

class UserManager {
  private users: Map<number, User> = new Map();
  private nextId: number = 1;

  addUser(name: string, email: string): User {
    const user: User = {
      id: this.nextId++,
      name,
      email,
      roles: ['user']
    };
    this.users.set(user.id, user);
    return user;
  }

  getUser(id: number): User | undefined {
    return this.users.get(id);
  }

  async fetchUsers(): Promise<User[]> {
    const response = await fetch('/api/users');
    return response.json();
  }
}

// Usage
const manager = new UserManager();
const user = manager.addUser('John Doe', 'john@example.com');</code></pre>
    </div>

    <!-- LaTeX Example -->
    <div class="language-example">
        <div class="example-header">
            <h3>LaTeX</h3>
            <span class="file-extension">.tex</span>
        </div>
        <div class="example-description">
            Document markup language used for creating professional scientific and technical documents.
        </div>
        <pre><code class="language-latex">\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{cite}

\title{A Comprehensive Guide to LaTeX}
\author{Jane Smith}
\date{\today}

\begin{document}

\maketitle

\section{Introduction}
This is the introduction section with a citation \cite{einstein1905}.

\section{Mathematics}
The quadratic formula is:
\[
x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}
\]

\begin{equation}
E = mc^2
\label{eq:einstein}
\end{equation}

See Equation~\ref{eq:einstein} for Einstein's famous equation.

\begin{thebibliography}{99}
\bibitem{einstein1905} Einstein, A. (1905). On the electrodynamics of moving bodies.
\end{thebibliography}

\end{document}</code></pre>
    </div>

    <!-- JSON Example -->
    <div class="language-example">
        <div class="example-header">
            <h3>JSON</h3>
            <span class="file-extension">.json</span>
        </div>
        <div class="example-description">
            Data format for storing and exchanging structured data. Lightweight and human-readable.
        </div>
        <pre><code class="language-json">{
  "project": {
    "name": "SciTeX Cloud",
    "version": "1.0.0",
    "description": "Scientific document platform with collaborative features",
    "keywords": ["science", "latex", "collaboration", "cloud"],
    "authors": [
      {
        "name": "Y. Watanabe",
        "email": "ywatanabe@example.com"
      }
    ],
    "features": {
      "syntax_highlighting": true,
      "collaborative_editing": true,
      "version_control": true,
      "supported_languages": 30
    },
    "files": [
      "package.json",
      "tsconfig.json",
      "README.md"
    ]
  }
}</code></pre>
    </div>

    <!-- Markdown Example -->
    <div class="language-example">
        <div class="example-header">
            <h3>Markdown</h3>
            <span class="file-extension">.md</span>
        </div>
        <div class="example-description">
            Lightweight markup language for creating formatted documents and documentation.
        </div>
        <pre><code class="language-markdown"># Syntax Highlighting Gallery

## Overview
This gallery demonstrates syntax highlighting for various file types.

### Features
- **Multiple Languages**: Support for 30+ programming languages
- **Custom Languages**: BibTeX, LaTeX, and specialized formats
- **Theme Support**: Both light and dark themes available
- **Line Numbers**: Automatic line numbering

## Code Example

```python
def hello_world():
    print("Hello, World!")
```

## BibTeX Citation
See [@einstein1905] for more information.

## Conclusion
Syntax highlighting improves code readability and understanding.

---

*Last updated: 2025-11-05*</code></pre>
    </div>

    <!-- YAML Example -->
    <div class="language-example">
        <div class="example-header">
            <h3>YAML</h3>
            <span class="file-extension">.yml, .yaml</span>
        </div>
        <div class="example-description">
            Configuration file format. Human-readable and used for config files and CI/CD pipelines.
        </div>
        <pre><code class="language-yaml"># Django Settings Configuration
DEBUG: true
ALLOWED_HOSTS:
  - localhost
  - 127.0.0.1
  - scitex.ai

DATABASE:
  ENGINE: postgresql
  NAME: scitex_cloud
  USER: postgres
  PASSWORD: secure_password
  HOST: localhost
  PORT: 5432

INSTALLED_APPS:
  - django.contrib.auth
  - django.contrib.contenttypes
  - apps.project_app
  - apps.scholar_app
  - apps.writer_app

LOGGING:
  version: 1
  disable_existing_loggers: false
  handlers:
    console:
      class: logging.StreamHandler
    file:
      class: logging.FileHandler
      filename: logs/django.log
  loggers:
    django:
      handlers: [console, file]
      level: INFO</code></pre>
    </div>

    <!-- Bash Example -->
    <div class="language-example">
        <div class="example-header">
            <h3>Bash/Shell</h3>
            <span class="file-extension">.sh</span>
        </div>
        <div class="example-description">
            Shell script language for system automation and command execution.
        </div>
        <pre><code class="language-bash">#!/bin/bash

# Script to deploy SciTeX application
set -e  # Exit on error

PROJECT_ROOT="/home/ywatanabe/proj/scitex-cloud"
ENV="${1:-.env.prod}"

echo "Deploying SciTeX Cloud..."
echo "Using environment: $ENV"

# Load environment variables
if [ -f "$PROJECT_ROOT/$ENV" ]; then
    source "$PROJECT_ROOT/$ENV"
    echo "âœ“ Environment loaded"
else
    echo "âœ— Environment file not found: $ENV"
    exit 1
fi

# Build project
cd "$PROJECT_ROOT"
python manage.py collectstatic --noinput
python manage.py migrate

# Restart services
systemctl restart gunicorn
systemctl restart nginx

echo "âœ“ Deployment complete!"</code></pre>
    </div>

    <!-- Language Support Table -->
    <div class="language-support-section">
        <h3>Supported Languages</h3>
        <p>The following programming and markup languages are fully supported with syntax highlighting:</p>
        
        <table class="language-table">
            <thead>
                <tr>
                    <th>Category</th>
                    <th>Languages</th>
                    <th>Extensions</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Programming</strong></td>
                    <td>Python, JavaScript, TypeScript, Java, C/C++, Go, Rust, Ruby, PHP, Swift, Kotlin, Scala</td>
                    <td>.py, .js, .ts, .java, .c, .cpp, .go, .rs, .rb, .php, .swift, .kt, .scala</td>
                </tr>
                <tr>
                    <td><strong>Markup & Docs</strong></td>
                    <td>HTML, XML, Markdown, LaTeX, BibTeX</td>
                    <td>.html, .xml, .md, .tex, .bib</td>
                </tr>
                <tr>
                    <td><strong>Styling</strong></td>
                    <td>CSS, SCSS, SASS</td>
                    <td>.css, .scss, .sass</td>
                </tr>
                <tr>
                    <td><strong>Config & Data</strong></td>
                    <td>JSON, YAML, SQL, TOML, INI</td>
                    <td>.json, .yaml, .yml, .sql, .toml, .ini</td>
                </tr>
                <tr>
                    <td><strong>Shell & Build</strong></td>
                    <td>Bash, Shell, Dockerfile, Makefile</td>
                    <td>.sh, .bash, Dockerfile, Makefile</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Custom Language Registration -->
    <div class="custom-languages-section">
        <h3>Custom Language Definitions</h3>
        <p>The following languages have custom implementations for improved syntax highlighting:</p>
        
        <div class="custom-lang-card">
            <h4>BibTeX</h4>
            <p>Custom definition with support for:</p>
            <ul>
                <li>Entry types (@article, @book, @inproceedings, etc.)</li>
                <li>Field names (author, title, year, doi, etc.)</li>
                <li>Comments (% to end of line)</li>
                <li>String literals and numbers</li>
            </ul>
        </div>
    </div>

    <!-- Theme Switching Note -->
    <div class="theme-info">
        <p><strong>ðŸ’¡ Tip:</strong> Code blocks automatically adapt to your chosen theme. Switch between light and dark themes in the <a href="{% url 'dev_app:design-section' section='theme' %}">Theme section</a> to see how the syntax highlighting adapts.</p>
    </div>
</div>

<style>
.syntax-highlighting-gallery {
    max-width: 100%;
    padding: 2rem;
}

.intro-section {
    background: var(--color-canvas-subtle);
    border-left: 4px solid var(--color-accent-emphasis);
    padding: 1.5rem;
    border-radius: 6px;
    margin-bottom: 2rem;
}

.intro-section p {
    margin: 0.5rem 0;
    color: var(--color-fg-default);
}

.language-example {
    margin-bottom: 3rem;
    background: var(--color-canvas-default);
    border: 1px solid var(--color-border-default);
    border-radius: 6px;
    overflow: hidden;
}

.example-header {
    background: var(--color-canvas-subtle);
    padding: 1rem;
    border-bottom: 1px solid var(--color-border-default);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.example-header h3 {
    margin: 0;
    font-size: 1.2rem;
}

.file-extension {
    background: var(--color-accent-emphasis);
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-family: var(--font-mono);
    font-size: 0.875rem;
    font-weight: 600;
}

.example-description {
    padding: 1rem;
    border-bottom: 1px solid var(--color-border-default);
    color: var(--color-fg-muted);
    font-size: 0.95rem;
}

.example-code {
    padding: 0;
}

.language-support-section,
.custom-languages-section {
    margin-top: 3rem;
}

.language-support-section h3,
.custom-languages-section h3 {
    margin-top: 0;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid var(--color-accent-emphasis);
}

.language-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
}

.language-table th,
.language-table td {
    padding: 0.75rem;
    text-align: left;
    border-bottom: 1px solid var(--color-border-default);
}

.language-table th {
    background: var(--color-canvas-subtle);
    font-weight: 600;
    color: var(--color-fg-default);
}

.language-table tr:hover {
    background: var(--color-canvas-subtle);
}

.language-table td strong {
    color: var(--color-fg-default);
}

.custom-lang-card {
    background: var(--color-canvas-subtle);
    padding: 1rem;
    border-radius: 6px;
    margin-top: 1rem;
    border-left: 3px solid var(--color-accent-emphasis);
}

.custom-lang-card h4 {
    margin-top: 0;
    color: var(--color-fg-default);
}

.custom-lang-card ul {
    margin: 0.5rem 0;
    padding-left: 1.5rem;
}

.custom-lang-card li {
    margin: 0.25rem 0;
    color: var(--color-fg-muted);
}

.theme-info {
    background: var(--color-attention-subtle);
    border-left: 4px solid var(--color-attention-fg);
    padding: 1rem;
    border-radius: 6px;
    margin-top: 2rem;
    color: var(--color-fg-default);
}

.theme-info a {
    color: var(--color-accent-fg);
    text-decoration: none;
}

.theme-info a:hover {
    text-decoration: underline;
}
</style>
