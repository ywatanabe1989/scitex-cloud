{% extends "cloud_app/base.html" %}
{% load static %}

{% block title %}Verify Your Email - SciTeX{% endblock %}

{% block extra_css %}
<style>
  .verify-container {
    max-width: 500px;
    margin: 4rem auto;
    padding: 2rem;
    background: white;
    border-radius: var(--border-radius-lg);
    box-shadow: var(--box-shadow-lg);
  }
  
  .verify-header {
    text-align: center;
    margin-bottom: 2rem;
  }
  
  .verify-icon {
    font-size: 3rem;
    color: var(--scitex-color-04);
    margin-bottom: 1rem;
  }
  
  .email-display {
    background: var(--scitex-color-07);
    padding: 1rem;
    border-radius: var(--border-radius);
    text-align: center;
    margin-bottom: 2rem;
    font-family: var(--mono-font-family);
    color: var(--scitex-color-01);
  }
  
  .code-input-container {
    margin-bottom: 2rem;
  }
  
  .code-input {
    text-align: center;
    font-size: 2rem;
    letter-spacing: 0.5rem;
    font-family: var(--mono-font-family);
    padding: 1rem;
  }
  
  .code-input:focus {
    border-color: var(--scitex-color-04);
    box-shadow: 0 0 0 3px rgba(var(--scitex-color-04-rgb), 0.1);
  }
  
  .verify-info {
    text-align: center;
    color: var(--text-light);
    margin-bottom: 1rem;
  }
  
  .resend-link {
    text-align: center;
    margin-top: 2rem;
  }
  
  .resend-link a {
    color: var(--scitex-color-03);
    text-decoration: none;
  }
  
  .resend-link a:hover {
    text-decoration: underline;
  }
</style>
{% endblock %}

{% block content %}
<div class="container">
  <div class="verify-container">
    <div class="verify-header">
      <div class="verify-icon">
        <i class="fas fa-envelope-open-text"></i>
      </div>
      <h2>Verify Your Email</h2>
      <p>We've sent a 6-digit verification code to:</p>
    </div>
    
    <div class="email-display">
      {{ email }}
    </div>
    
    <form method="POST">
      {% csrf_token %}
      
      <div class="code-input-container">
        <label for="{{ form.code.id_for_label }}" class="form-label">Enter Verification Code</label>
        {{ form.code }}
        {% if form.code.errors %}
          <div class="text-danger mt-2">
            {{ form.code.errors.0 }}
          </div>
        {% endif %}
      </div>
      
      <div class="verify-info">
        <small>The code will expire in 15 minutes</small>
      </div>
      
      <button type="submit" class="btn btn-primary btn-lg w-100">
        Verify Email
      </button>
    </form>
    
    <div class="resend-link">
      <p>Didn't receive the code? <a href="{% url 'cloud_app:donate' %}">Send a new code</a></p>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Auto-focus on code input
  const codeInput = document.querySelector('.code-input');
  if (codeInput) {
    codeInput.focus();
  }
  
  // Format input as user types
  codeInput.addEventListener('input', function(e) {
    // Remove non-digits
    this.value = this.value.replace(/[^0-9]/g, '');
    
    // Auto-submit when 6 digits are entered
    if (this.value.length === 6) {
      // Optional: auto-submit the form
      // this.form.submit();
    }
  });
});
</script>
{% endblock %}