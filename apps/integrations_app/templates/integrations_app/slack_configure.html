{% extends "global_base.html" %}
{% block title %}Configure Slack - SciTeX{% endblock %}
    {% block content %}
        <div class="container py-4" style="max-width: 600px">
            <h1 class="mb-4">Configure Slack Notifications</h1>
            <div class="card">
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        <div class="mb-4">
                            <label for="webhook_url" class="form-label">
                                Webhook URL <span class="text-danger">*</span>
                            </label>
                            <input type="url"
                                   name="webhook_url"
                                   id="webhook_url"
                                   required
                                   class="form-control"
                                   placeholder="https://hooks.slack.com/services/..." />
                            <div class="form-text">
                                Get your webhook URL from Slack:
                                <a href="https://api.slack.com/messaging/webhooks"
                                   target="_blank"
                                   class="text-decoration-none">Create Incoming Webhook</a>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label for="channel" class="form-label">Channel (optional)</label>
                            <input type="text"
                                   name="channel"
                                   id="channel"
                                   class="form-control"
                                   placeholder="#general" />
                            <div class="form-text">Override default channel (leave empty to use webhook default)</div>
                        </div>
                        <div class="mb-4">
                            <label class="form-label">
                                Notification Events <span class="text-danger">*</span>
                            </label>
                            <div class="d-flex flex-column gap-2">
                                {% for value, label in available_events %}
                                    <div class="form-check">
                                        <input
                                            type="checkbox"
                                            name="enabled_events"
                                            value="{{ value }}"
                                            id="event_{{ value }}"
                                            {% if value == "project_created" or value == "manuscript_updated" or value == "analysis_completed" %}checked{% endif %}
                                            class="form-check-input"
                                            />
                                            <label class="form-check-label" for="event_{{ value }}">{{ label }}</label>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-primary flex-fill">Save Configuration</button>
                                <a href="{% url 'integrations_app:dashboard' %}"
                                   class="btn btn-outline-secondary flex-fill">Cancel</a>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="alert-banner alert-banner-info"
                     style="margin-top: var(--spacing-lg)">
                    <div class="warning-banner-container">
                        <div class="warning-banner-content">
                            <i class="warning-banner-icon fas fa-info-circle"></i>
                            <div class="warning-banner-text">
                                <div class="warning-banner-title">How to get a Slack webhook URL</div>
                                <div class="warning-banner-description">
                                    1. Go to
                                    <a href="https://api.slack.com/messaging/webhooks" target="_blank">Slack's Incoming Webhooks page</a>
                                    <br />
                                    2. Click "Create New App" and choose your workspace
                                    <br />
                                    3. Enable Incoming Webhooks and add a new webhook
                                    <br />
                                    4. Copy the webhook URL and paste it above
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endblock %}
