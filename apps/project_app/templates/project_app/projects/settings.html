{% extends "global_base.html" %}
{% load static %}

{% block title %}Settings - {{ project.name }} - SciTeX{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'project_app/css/project_app.css' %}">
<link rel="stylesheet" href="{% static 'css/common/buttons.css' %}">

{% endblock %}

{% block content %}
<div class="settings-container">
    <!-- Breadcrumb -->
    <div style="margin-bottom: 24px;">
        <a href="/{{ project.owner.username }}/" style="color: var(--color-accent-fg);">{{ project.owner.username }}</a>
        <span style="color: var(--color-fg-muted);"> / </span>
        <a href="{{ project.get_absolute_url }}" style="color: var(--color-accent-fg);">{{ project.name }}</a>
        <span style="color: var(--color-fg-muted);"> / </span>
        <span style="color: var(--color-fg-default); font-weight: 600;">Settings</span>
    </div>

    <!-- Django Messages Display -->
    {% if messages %}
    <div id="messages-container" style="margin-bottom: 24px;">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}" role="alert" style="padding: 12px 16px; margin-bottom: 8px; border-radius: 6px; border-left: 4px solid {% if message.tags == 'success' %}#10b981{% elif message.tags == 'error' %}#ef4444{% elif message.tags == 'warning' %}#f59e0b{% else %}#3b82f6{% endif %}; background: {% if message.tags == 'success' %}#d1fae5{% elif message.tags == 'error' %}#fee2e2{% elif message.tags == 'warning' %}#fef3c7{% else %}#dbeafe{% endif %}; color: var(--color-fg-default);">
            <strong>{% if message.tags == 'success' %}✓{% elif message.tags == 'error' %}✗{% elif message.tags == 'warning' %}⚠{% else %}ℹ{% endif %}</strong>
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="settings-layout">
        <!-- Left Navigation -->
        {% include 'project_app/settings_partials/settings_navigation.html' %}

        <!-- Main Content -->
        <main class="settings-main">
            <form method="post" id="settingsForm" action="/{{ project.owner.username }}/{{ project.slug }}/settings/">
                {% csrf_token %}

                <!-- General Settings -->
                <div class="settings-section-wrapper" id="section-general" style="display: block;">
                    {% include 'project_app/settings_partials/settings_general.html' %}
                </div>

                <!-- Access & Visibility -->
                <div class="settings-section-wrapper" id="section-access" style="display: none;">
                    {% include 'project_app/settings_partials/settings_visibility.html' %}
                </div>

                <!-- Collaborators -->
                <div class="settings-section-wrapper" id="section-collaborators" style="display: none;">
                    {% include 'project_app/settings_partials/settings_collaborators.html' %}
                </div>
            </form>

            <!-- Danger Zone -->
            <div class="settings-section-wrapper" id="section-danger" style="display: none;">
                {% include 'project_app/settings_partials/settings_danger_zone.html' %}
            </div>
        </main>
    </div>
</div>

<!-- Delete Modal -->
{% include 'project_app/settings_partials/settings_delete_modal.html' %}
{% endblock %}

{% block extra_js %}
<script src="{% static 'project_app/js/settings.js' %}?v={{ cache_buster_value }}"></script>
{% endblock %}
