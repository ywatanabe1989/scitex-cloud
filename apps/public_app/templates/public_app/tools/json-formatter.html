{% extends "global_base.html" %}
{% block title %}JSON Formatter - Browser Tool | SciTeX{% endblock %}
{% block meta_description %}Format, validate, and beautify JSON data. Syntax highlighting and error detection.{% endblock %}
{% block extra_css %}
    <style>
  .tool-detail-container { max-width: 1400px; margin: 0 auto; padding: 40px 20px; }
  .tool-header { text-align: center; padding: 40px 20px; margin-bottom: 40px; }
  .tool-title { font-size: 42px; font-weight: 700; margin-bottom: 16px; }
  .tool-breadcrumb { font-size: 14px; margin-bottom: 16px; }
  .tool-breadcrumb a { color: #4a9b7e; text-decoration: none; }
  .editor-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 600px; }
  .editor-panel { background: var(--bg-secondary); border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; }
  .panel-header { background: var(--bg-tertiary); padding: 15px 20px; border-bottom: 1px solid var(--border-color); }
  .panel-title { font-weight: 600; font-size: 16px; }
  .json-textarea { flex: 1; border: none; padding: 20px; font-family: 'Courier New', monospace; font-size: 13px; resize: none; background: var(--bg-primary); }
  .json-output { flex: 1; padding: 20px; overflow: auto; background: var(--bg-primary); font-family: 'Courier New', monospace; font-size: 13px; }
  .controls { display: flex; gap: 10px; padding: 15px 20px; border-top: 1px solid var(--border-color); background: var(--bg-tertiary); }
  .btn { padding: 8px 16px; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; border: none; }
  .btn-primary { background: #4a9b7e; color: white; }
  .btn-primary:hover { background: #3a7c65; }
  .status { padding: 10px 20px; text-align: center; font-size: 13px; }
  .status.error { color: #dc2626; background: #fef2f2; }
  .status.success { color: #15803d; background: #f0fdf7; }
  .json-key { color: #8b5cf6; }
  .json-string { color: #15803d; }
  .json-number { color: #dc2626; }
  .json-boolean { color: #ea580c; }
  .json-null { color: #6b7280; }
    </style>
{% endblock %}
{% block content %}
    <div class="tool-detail-container">
        <div class="tool-breadcrumb"><a href="{% url 'public_app:tools' %}">‚Üê Back to Tools</a></div>
        <div class="tool-header">
            <div style="font-size: 64px; margin-bottom: 20px;">{ }</div>
            <h1 class="tool-title">JSON Formatter</h1>
            <p style="font-size: 18px; color: var(--text-secondary);">Format and validate JSON data</p>
        </div>
        <div class="editor-container">
            <div class="editor-panel">
                <div class="panel-header"><span class="panel-title">‚úèÔ∏è Input JSON</span></div>
                <textarea id="jsonInput" class="json-textarea" placeholder='{"name": "example", "value": 123}'></textarea>
                <div class="controls">
                    <button id="formatBtn" class="btn btn-primary">üé® Format</button>
                    <button id="minifyBtn" class="btn btn-primary">üì¶ Minify</button>
                    <button id="validateBtn" class="btn btn-primary">‚úì Validate</button>
                    <button id="copyBtn" class="btn btn-primary">üìã Copy</button>
                </div>
            </div>
            <div class="editor-panel">
                <div class="panel-header"><span class="panel-title">üëÅÔ∏è Output</span></div>
                <div id="jsonOutput" class="json-output"></div>
                <div id="status" class="status" style="display: none;"></div>
            </div>
        </div>
    </div>
    <script>
  const jsonInput = document.getElementById('jsonInput');
  const jsonOutput = document.getElementById('jsonOutput');
  const status = document.getElementById('status');

  function showStatus(message, type) {
    status.textContent = message;
    status.className = `status ${type}`;
    status.style.display = 'block';
  }

  function syntaxHighlight(json) {
    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
    return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, (match) => {
      let cls = 'json-number';
      if (/^"/.test(match)) {
        cls = /:$/.test(match) ? 'json-key' : 'json-string';
      } else if (/true|false/.test(match)) {
        cls = 'json-boolean';
      } else if (/null/.test(match)) {
        cls = 'json-null';
      }
      return `<span class="${cls}">${match}</span>`;
    });
  }

  document.getElementById('formatBtn').addEventListener('click', () => {
    try {
      const obj = JSON.parse(jsonInput.value);
      const formatted = JSON.stringify(obj, null, 2);
      jsonOutput.innerHTML = `<pre>${syntaxHighlight(formatted)}</pre>`;
      showStatus('‚úì JSON formatted successfully', 'success');
    } catch (e) {
      showStatus(`‚úó Invalid JSON: ${e.message}`, 'error');
    }
  });

  document.getElementById('minifyBtn').addEventListener('click', () => {
    try {
      const obj = JSON.parse(jsonInput.value);
      const minified = JSON.stringify(obj);
      jsonOutput.textContent = minified;
      showStatus('‚úì JSON minified successfully', 'success');
    } catch (e) {
      showStatus(`‚úó Invalid JSON: ${e.message}`, 'error');
    }
  });

  document.getElementById('validateBtn').addEventListener('click', () => {
    try {
      JSON.parse(jsonInput.value);
      showStatus('‚úì Valid JSON!', 'success');
    } catch (e) {
      showStatus(`‚úó Invalid JSON: ${e.message}`, 'error');
    }
  });

  document.getElementById('copyBtn').addEventListener('click', () => {
    const text = jsonOutput.textContent;
    navigator.clipboard.writeText(text);
    showStatus('‚úì Copied to clipboard', 'success');
  });
    </script>
{% endblock %}
